# Omnivore - Read-it-later Application Rules

## Project Overview

Omnivore is a complete, open-source read-it-later solution with web, mobile, and browser extension clients. The architecture uses:

- GraphQL API backend (Node.js/TypeScript)
- Next.js frontend with TypeScript
- PostgreSQL database with vector extensions
- Redis for caching and queues
- Microservices for content processing
- Mobile apps (iOS/Android)
- Browser extensions

## Core Architecture Principles

### Monorepo Structure

- Use Lerna for package management across the monorepo
- Each service should be in its own package under `packages/` or `pkg/`
- Shared utilities should be in `packages/utils`
- Database schemas and migrations in `packages/db`
- Web frontend in `packages/web`
- API server in `packages/api`

### Technology Stack

- **Backend**: Node.js 22 (migrating to 23 after stabilization), TypeScript, GraphQL
- **Frontend**: Next.js with App Router, React, TypeScript, Stitches
- **Database**: PostgreSQL with vector extensions, Redis for caching/queues
- **Mobile**: Swift/SwiftUI (iOS), Kotlin/Compose (Android)
- **Testing**: Jest (preferred), Mocha/Chai (legacy - gradually phase out)

### Development Standards

- Use strict TypeScript configuration throughout
- Implement comprehensive testing (80% coverage minimum)
- Follow security best practices (JWT auth, input validation, HTTPS)
- Use Docker containers for all services
- Implement proper error handling and logging
- Follow GraphQL-first API design
- Maintain cross-platform compatibility

## Detailed Guidelines

For comprehensive development guidelines, refer to the organized cursor rules in the `cursor-rules/` directory:

- **[Frontend Development](./cursor-rules/frontend-frameworks-cursorrules.md)** - Next.js, React patterns
- **[Backend Development](./cursor-rules/backend-fullstack-cursorrules.md)** - GraphQL, microservices
- **[Mobile Development](./cursor-rules/mobile-development-cursorrules.md)** - iOS, Android, extensions
- **[Database & API](./cursor-rules/database-api-cursorrules.md)** - PostgreSQL, Redis patterns
- **[Testing](./cursor-rules/testing-cursorrules.md)** - Jest, E2E, coverage standards
- **[Build Tools](./cursor-rules/build-tools-development-cursorrules.md)** - Lerna, Docker, CI/CD
- **[Language-Specific](./cursor-rules/language-specific-cursorrules.md)** - TypeScript, Swift, Kotlin
- **[Security](./cursor-rules/security-cursorrules.md)** - Authentication, data protection

## AI Agent Guidelines

For AI assistants and automated tools working on this codebase, refer to [AGENTS.md](./AGENTS.md) for:

- Expected behaviors and contribution patterns
- Code quality standards and testing requirements
- Security considerations and best practices
- Communication protocols and workflow guidelines

## Critical Considerations

**Multi-Platform Impact**: This is a complex application with multiple platforms. Always consider the impact of changes across web, mobile, and browser extension clients. Prioritize user experience and data consistency across all platforms.

**Migration Strategy**: Gradually migrate from Mocha/Chai to Jest for testing. Use Node.js 22 for stability, plan migration to 23 after project stabilization.

**Performance**: Implement proper caching, optimize bundle sizes, use appropriate database indexing, and monitor performance metrics across all platforms.
